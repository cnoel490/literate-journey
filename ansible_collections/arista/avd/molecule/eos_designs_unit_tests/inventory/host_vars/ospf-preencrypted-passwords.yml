---
# Tests using pre-encrypted OSPF passwords

type: l3leaf

l3leaf:
  defaults:
    loopback_ipv4_pool: 192.168.66.0/24
    vtep_loopback_ipv4_pool: 192.168.142.0/24
    virtual_router_mac_address: 00:11:22:33:44:55
    bgp_as: 666
  nodes:
    - name: ospf-preencrypted-passwords
      id: 43
      mgmt_ip: 192.168.42.43/24

tenants:
  - name: Tenant_OSPF
    mac_vrf_vni_base: 10000
    mac_vrf_id_base: 20000
    redistribute_mlag_ibgp_peering_vrfs: true
    vrfs:
      - name: Tenant_OSPF_VRF_LEVEL_SIMPLE_ENCRYPTION
        vrf_vni: 100
        vrf_id: 42
        ospf:
          enabled: true
          router_id: 10.10.10.10
          # The VRF is configured with OSPF auth method simple
          authentication: simple
          cleartext_simple_auth_key: password
          nodes: [ospf-preencrypted-passwords]
        svis:
          # test ospf simple authentication at SVI level overwriting VRF level
          - id: 204
            name: Tenant_OSPF_204
            enabled: true
            description: "Overwriting auth from VRF with simple"
            ip_address_virtual: 10.1.40.1/24
            ospf:
              enabled: true
              area: 1
              cost: 100
              authentication: simple
              simple_auth_key: P6e73mHkLBd2exwHPq6K3A==
        l3_interfaces:
          - interfaces: [Ethernet1]
            ip_addresses: [10.10.70.70/24]
            nodes: [ospf-preencrypted-passwords]
            mtu: 9000
            enabled: true
            description: "Overwriting auth from VRF with message-digest"
            ospf:
              enabled: true
              cost: 100
              authentication: message-digest
              point_to_point: true
              message_digest_keys:
                - id: 1
                  hash_algorithm: sha1
                  key: CSjTKv7UtuWSOX61bToedQ==
          - interfaces: [Ethernet2]
            ip_addresses: [10.10.20.20/24]
            nodes: [ospf-preencrypted-passwords]
            description: "Inheriting auth from VRF"
            mtu: 9000
            enabled: true
            ospf:
              enabled: true
              cost: 100
              point_to_point: true
      - name: Tenant_OSPF_VRF_LEVEL_MESSAGE_DIGEST_ENCRYPTION
        vrf_vni: 101
        vrf_id: 43
        ospf:
          enabled: true
          router_id: 10.10.10.20
          # The VRF is configured with OSPF auth method message-digest
          authentication: message-digest
          message_digest_keys:
            - id: 1
              hash_algorithm: sha256
              cleartext_key: arista
          nodes: [ospf-preencrypted-passwords]
        svis:
          - id: 213
            name: Tenant_OSPF_213
            description: "Overwriting auth from VRF with simple"
            enabled: true
            ip_address_virtual: 10.1.30.1/24
            ospf:
              enabled: true
              area: 1
              cost: 100
              authentication: simple
              simple_auth_key: 9lUSaRCtplbyboJZn9kq5g==
        l3_interfaces:
          - interfaces: [Ethernet3]
            ip_addresses: [10.10.70.70/24]
            nodes: [ospf-preencrypted-passwords]
            mtu: 9000
            enabled: true
            description: "Overwriting auth from VRF with message-digest"
            ospf:
              enabled: true
              cost: 100
              authentication: message-digest
              point_to_point: true
              message_digest_keys:
                - id: 1
                  hash_algorithm: sha512
                  key: g73J3pK8WsFSHE+mvk4W8A==
          - interfaces: [Ethernet4]
            ip_addresses: [10.10.20.20/24]
            nodes: [ospf-preencrypted-passwords]
            mtu: 9000
            enabled: true
            description: "Inheriting auth from VRF"
            ospf:
              enabled: true
              cost: 100
              point_to_point: true
      - name: Tenant_OSPF_NO_VRF_LEVEL_ENCRYPTION
        vrf_vni: 102
        vrf_id: 44
        ospf:
          enabled: true
          # The VRF is configured without any OSPF encryption method
        svis:
          # test ospf authentication inherited from VRF vlan interface
          # Expect NO authentication
          - id: 222
            name: Tenant_OSPF_222
            enabled: true
            ospf:
              enabled: true
              point_to_point: true
        l3_interfaces:
          - interfaces: [Ethernet5]
            ip_addresses: [10.10.70.70/24]
            nodes: [ospf-preencrypted-passwords]
            mtu: 9000
            enabled: true
            description: "Overwriting auth from VRF with message-digest"
            ospf:
              enabled: true
              cost: 100
              authentication: message-digest
              point_to_point: true
              message_digest_keys:
                - id: 1
                  hash_algorithm: sha384
                  key: HETNWQ4hixKxgZv7UHHb9w==
          - interfaces: [Ethernet6]
            ip_addresses: [10.10.20.20/24]
            nodes: [ospf-preencrypted-passwords]
            mtu: 9000
            enabled: true
            description: "Inheriting no auth from VRF"
            ospf:
              enabled: true
              cost: 100
              point_to_point: true
