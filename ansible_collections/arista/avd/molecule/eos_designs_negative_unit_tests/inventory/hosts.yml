---
all:
  children:
    EOS_DESIGNS_FACTS_FAILURES: # Add cases that fail during 'eos_designs_facts' phase.
      # Each case _must_ be in it's own 'fabric' group set as 'fabric_name' in the hostvars
      # Each case must be added to converge.yml as a separate play - otherwise the eos_designs_facts fabric_name check will fail.
      children:
        FABRIC_MISSING_CV_TOPOLOGY_KEY:
          hosts:
            missing-cv-topology:
        FABRIC_MISSING_CV_TOPOLOGY_DEFAULT_UPLINK_INTERFACES:
          hosts:
            missing-cv-topology-default-uplink-interfaces:
        FABRIC_MISSING_CV_TOPOLOGY_DEFAULT_MLAG_INTERFACEES:
          hosts:
            missing-cv-topology-default-mlag-interfaces-peer1:
            missing-cv-topology-default-mlag-interfaces-peer2:
        FABRIC_MISSING_LOOPBACK_IPV4_POOL:
          hosts:
            missing-loopback-ipv4-pool:
        FABRIC_MISSING_VTEP_LOOPBACK_IPV4_POOL:
          hosts:
            missing-vtep-loopback-ipv4-pool:
        FABRIC_MISSING_MLAG_PEER:
          hosts:
            missing-mlag-peer:
        FABRIC_IP_ADDRESSING_MLAG_ODD_ID:
          hosts:
            mlag_odd_id_oddodd1:
            mlag_odd_id_oddodd2:
        FABRIC_INVALID_SCHEMA:
          hosts:
            invalid-schema:
        FABRIC_INVALID_SCHEMA_CONNECTED_ENDPOINTS:
          hosts:
            invalid-schema-connected-endpoints:
        FABRIC_INVALID_UPLINK_PORT_CHANNEL_ID_1:
          hosts:
            invalid-uplink-port-channel-id-1-l3leaf-1:
            invalid-uplink-port-channel-id-1-l3leaf-2:
            invalid-uplink-port-channel-id-1-l2leaf-1:
            invalid-uplink-port-channel-id-1-l2leaf-2:
        FABRIC_INVALID_UPLINK_PORT_CHANNEL_ID_2:
          hosts:
            invalid-uplink-port-channel-id-2-l3leaf-1:
            invalid-uplink-port-channel-id-2-l3leaf-2:
            invalid-uplink-port-channel-id-2-l2leaf-1:
            invalid-uplink-port-channel-id-2-l2leaf-2:
        FABRIC_INVALID_UPLINK_PORT_CHANNEL_ID_3:
          hosts:
            invalid-uplink-port-channel-id-3-l2leaf-1:
            invalid-uplink-port-channel-id-3-l3leaf-1:
            invalid-uplink-port-channel-id-3-l3leaf-2:
            invalid-uplink-port-channel-id-3-l2leaf-2:
        FABRIC_P2P_VRFS:
          hosts:
            invalid-uplink-type-p2p-vrfs-underlay-router-false:
        FABRIC_DOWNLINK_POOLS_MISSING:
          hosts:
            downlink-pools-missing-spine:
            downlink-pools-missing-l3leaf:
        FABRIC_DOWNLINK_POOLS_DUPLICATE:
          hosts:
            downlink-pools-duplicate-spine:
            downlink-pools-duplicate-l3leaf:
        FAILURE_CONNECTED_ENDPOINT_PORT_PROFILE_DOES_NOT_EXIST_IN_FACTS:
          hosts:
            failure-connected-endpoint-port-profile-does-not-exist-in-facts:
        MISSING_BGP_AS_WITH_L3_INTERFACES_BGP_PEERS:
          hosts:
            missing-bgp-as-with-l3-interfaces-bgp-peers:
        FABRIC_ID_STATIC_AND_POOL_MANAGER:
          hosts:
            id-static-and-pool-manager:
        FABRIC_UNDEFINED_PEER:
          hosts:
            undefined-peer-facts:
        FABRIC_INBAND_MANAGEMENT:
          hosts:
            inband-mgmt-missing-id-with-subnet:
        FABRIC_INBAND_MANAGEMENT_IPV6:
          hosts:
            inband-mgmt-missing-id-with-ipv6-subnet:
        FABRIC_MISSING_MLAG_PEER_IPV4_POOL:
          hosts:
            missing-mlag-peer-ipv4-pool1:
            missing-mlag-peer-ipv4-pool2:
        FABRIC_MISSING_MLAG_PEER_L3_IPV4_POOL:
          hosts:
            missing-mlag-peer-l3-ipv4-pool1:
            missing-mlag-peer-l3-ipv4-pool2:
        FABRIC_MISSING_MLAG_INTERFACES:
          hosts:
            missing-mlag-interfaces1:
        FABRIC_MISSING_MLAG_PEER_IPV6_POOL:
          hosts:
            missing-mlag-peer-ipv6-pool1:
        FABRIC_MISSING_ID_FOR_MLAG:
          hosts:
            missing-id-for-mlag1:
        FABRIC_MISSING_ID_FOR_SECONDARY_MLAG:
          hosts:
            missing-id-for-secondary-mlag2:

    EOS_DESIGNS_FAILURES: # Add cases that fail during 'eos_designs_structured_config' phase
      children:
        EOS_DESIGNS_FAILURES_INCLUDED:
          hosts:
            avd_eos_designs_enforce_duplication_checks_across_all_models:
            failure-port-channel:
            connected-endpoints-mismatched-descriptions:
            connected-endpoints-missing-profile-lacp-fallback:
            connected-endpoints-wrong-profile-lacp-fallback:
            connected-endpoints-phone-vlan-mode:
            connected-endpoints-phone-vlan-vlans:
            connected-endpoints-monitor-session-connected-endpoint-acl:
            connected-endpoints-monitor-session-network-port-acl:
            connected-endpoints-monitor-sessions-mismatch-direction:
            connected-endpoints-invalid-access-vlan-ethernet:
            connected-endpoints-invalid-access-vlan-port-channel:
            duplicate_auto_generated_parent_network_services_point_to_point:
            duplicate-vlans-l2vlans:
            duplicate-vlans-svi-id:
            duplicate-vrfs-duplicate-svi-name-conflict:
            duplicate-vrfs-id-conflict:
            duplicate-vrfs-vni-conflict:
            duplicate-vrfs-tenant-igmp-snooping-conflict:
            duplicate-neighbors-l3-edge:
            duplicate-interface-l3-edge:
            duplicate-l3-interfaces-network-services:
            duplicate-peer-ip-address-network-services:
            duplicate-interfaces-network-ports-with-port-channel:
            duplicate-interfaces-point-to-point-services-1:
            duplicate-interfaces-point-to-point-services-2:
            duplicate-interfaces-point-to-point-services-3:
            duplicate-interfaces-point-to-point-services-4:
            duplicate-interfaces-connected-endpoints:
            duplicate-interfaces-core-interfaces:
            duplicate-interfaces-core-interfaces-with-port-channel:
            duplicate-vni-vxlan-interface:
            duplicate-vni-l3-interfaces-in-vxlan-interface:
            duplicate-vni-l2vlans-vxlan-interface:
            duplicate-interfaces-underlay:
            duplicate-ip-address-uplink-switch-router-bgp:
            duplicate-tunnel-interface-internet-exit:
            failure-connected-endpoint-parent-port-profile-does-not-exist:
            failure-connected-endpoint-port-profile-does-not-exist:
            failure-duplicate-evpn-vlan-bundle-name:
            failure-evpn-gateway-aa-mh-gw-interdomain-conflict:
            failure-evpn-gateway-aa-mh-gw-ipvpngw-conflict:
            failure-evpn-gateway-aa-mh-gw-mlag-conflict:
            failure-evpn-gateway-aa-mh-gw-platform-conflict:
            failure-l3-interface-profile-does-not-exist:
            failure-missing-evpn-vlan-bundle:
            failure-missing-evpn-vlan-bundle_svi:
            failure-missing-evpn-multicast-l3-with-pim:
            failure-missing-evpn-multicast-peg-rps:
            failure-missing-evpn-multicast-with-pim:
            failure-network-port-ptp-profile-does-not-exist:
            failure-p2p-links-more-than-2-nodes:
            failure-p2p-links-ptp-profile-does-not-exist:
            failure-no-local-path-group-in-default-policy:
            failure-adapter-ptp-profile-does-not-exist:
            failure-ptp-profile-does-not-exist:
            failure-svi-grandparent-profile-does-not-exist:
            failure-svi-parent-profile-does-not-exist:
            flow-tracking-missing-tracker:
            invalid-generate-cv-device-tags:
            invalid-generate-cv-device-tags-data-path:
            invalid-generate-cv-interface-tags-data-path:
            missing-valid-ipv4-address-ntp-servers-spine:
            ipv4-acl-in-missing-on-l3-port-channel-wan-interface:
            ipv4-acl-in-missing-on-wan-interface:
            ipv4-acls:
            ipv4-acls-internet-exit-access-lists:
            ipv4-acls-zscaler-internet-exit-access-lists:
            isis-system-id-format-missing-node-id:
            l3-port-channel-sub-interface-with-member-interfaces:
            l3-port-channel-sub-interface-with-mode:
            missing-avt-id-cv-pathfinder:
            missing-parent-of-l3-port-channel-sub-interface:
            missing-prefix-list-in-cv-pathfinder:
            missing-prefix-list-definition-cv-pathfinder:
            missing-data-plane_cpu-allocation-max:
            missing-generated-cv-device-tags-value-and-data-paths:
            missing-generated-cv-interface-tags-value-and-data-paths:
            missing-key-evpn-gateway-remote-peer:
            missing-wan-router-l3-interfaces-ip-address:
            missing-overlay-cvx-servers:
            missing-mgmt-ip-overlay-cvx-servers:
            missing-application-classification-application-profile:
            missing-application-classification-category:
            missing-application-classification-port-set:
            missing-application-classification-prefix-set:
            missing-loopback-ipv6-pool:
            missing-internet-exit-policy:
            missing-internet-exit-policy-direct-wan-interface-dhcp-ip:
            missing-internet-exit-policy-direct-wan-interface-peer-ip:
            missing-internet-exit-policy-zscaler-wan-interface-peer-ip:
            missing-internet-exit-policy-zscaler-wan-interface-tunnels-id:
            missing-control-plane-virtual-topology-path-groups:
            missing-default-virtual-topology-path-group:
            missing-peer-ip-l3-interface:
            missing-wan-ipsec-profiles:
            missing-mgmt-ip-ipv6-mgmt-ip:
            missing-inband-mgmt-interface:
            missing-mgmt-ip-cvx-servers:
            missing_cv_pathfinder_regions:
            missing_cv_pathfinder_path_group_with_preferred:
            missing-peer-router-id-for-router-pim-sparse-mode:
            wan-router-l3-interfaces-unsupported-rxtx-for-subinterface:
            wan-router-policy-unmatched:
            ntp-settings-server-vrf-missing-mgmt-ip:
            ntp-settings-server-vrf-missing-inband-mgmt-interface:
            sfe-interface-profile-duplicate-interface-members:
            sfe-interface-profile-exceed-max-rx-queue-cnt:
            sfe-interface-profile-worker-id-exceed-max:
            source-interfaces-domain-lookup-duplicate-vrf:
            source-interfaces-domain-lookup-missing-inband-mgmt-interface:
            source-interfaces-domain-lookup-missing-mgmt-ip:
            source-interfaces-http-client-duplicate-vrf:
            source-interfaces-http-client-missing-inband-mgmt-interface:
            source-interfaces-http-client-missing-mgmt-ip:
            source-interfaces-radius-duplicate-vrf:
            source-interfaces-radius-missing-inband-mgmt-interface:
            source-interfaces-radius-missing-mgmt-ip:
            source-interfaces-ssh-client-duplicate-vrf:
            source-interfaces-ssh-client-missing-inband-mgmt-interface:
            source-interfaces-ssh-client-missing-mgmt-ip:
            source-interfaces-tacacs-duplicate-vrf:
            source-interfaces-tacacs-missing-inband-mgmt-interface:
            source-interfaces-tacacs-missing-mgmt-ip:
            ul-filter-evpn-default-vrf-services:
            sflow-settings-missing-destinations:
            sflow-settings-missing-inband-mgmt-interface:
            sflow-settings-missing-mgmt-ip:
            core-interfaces-p2p-links-as:
            core-interfaces-missing-id-with-channel-id-algorithm:
            net-srv-l3-po-sub-interface-with-mode:
            net-srv-l3-po-sub-interface-with-mtu:
            net-srv-l3-po-sub-interface-with-members:
            net-srv-l3-po-sub-interface-without-main-po:
            net-srv-l3-po-sub-interface-without-ip:
            missing-wan-control-load-balance-policy:
            missing-default-policy-wan-control-load-balance-policy:
            missing-wan-policy-in-traffic-vrfs:
            p2p_links_missing_ip_subnet_ip_pool:

          children:
            DUPLICATE_VLANS_MLAG:
              hosts:
                duplicate-vlans-mlag-a:
                duplicate-vlans-mlag-b:
            VRF_BGP_VTEP_ROUTER_ID:
              hosts:
                vrf-bgp-vtep-router-id:
            VRF_OSPF_VTEP_ROUTER_ID:
              hosts:
                vrf-ospf-vtep-router-id:
            VRF_OSPF_MISSING_PROCESS_ID:
              hosts:
                vrf-ospf-missing-process-id:
            INVALID_DUAL_ROUTER_WAN_EVPN_GW:
              hosts:
                cv-pathfinder-edge-wan-use-evpn-on-lan-1:
                cv-pathfinder-edge-wan-use-evpn-on-lan-2:

        EOS_DESIGNS_FAILURES_EXCLUDED:
          # These hosts are included in the vars and facts, but will not be included in the structured config run,
          # since they are not present to trigger a failure on a different device.
          children:
            DUPLICATE_IP_ADDRESS_ROUTER_BGP:
              hosts:
                duplicate-ip-address-1:
                duplicate-ip-address-2:
