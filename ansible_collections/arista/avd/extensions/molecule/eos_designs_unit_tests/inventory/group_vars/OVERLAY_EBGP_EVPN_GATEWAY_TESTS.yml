---
type: l3leaf

# using default overlay_routing_protocol: ebgp
evpn_overlay_bgp_rtc: true

l3leaf:
  defaults:
    loopback_ipv4_pool: 192.168.255.0/24
    vtep_loopback_ipv4_pool: 192.168.254.0/24
    virtual_router_mac_address: 00:1c:73:00:00:99
    bgp_as: 65233
  nodes:
    - name: evpn_gateway_all_active_mh_gw
      id: 1
      filter:
        tenants: [ EVPN_GATEWAY_TESTS ]
      platform: vEOS
      mlag: false
      bgp_as: 65233
      mgmt_ip: 192.168.0.204/24
      evpn_gateway:
        all_active_multihoming:
          enabled: true
          enable_d_path: true
          evpn_domain_id_local: "65200:2"
          evpn_domain_id_remote: "65100:1"
          evpn_ethernet_segment:
            identifier: 0000:0001:0001:0000:0509
            rt_import: 00:00:00:00:07:09
        evpn_l2:
          enabled: true
        evpn_l3:
          enabled: true
          inter_domain: true
        remote_peers:
          - hostname: DCI_TEST
            ip_address: 192.168.100.10
            bgp_as: 65002
    - name: evpn_gateway_all_active_mh_gw_enabled_d_path_false
      id: 2
      filter:
        tenants: [ EVPN_GATEWAY_TESTS ]
      platform: vEOS
      mlag: false
      mgmt_ip: 192.168.0.205/24
      evpn_gateway:
        all_active_multihoming:
          enabled: true
          enable_d_path: false
          evpn_domain_id_local: "65200:1"
          evpn_domain_id_remote: "65100:2"
          evpn_ethernet_segment:
            identifier: 0000:0001:0001:0000:0509
            rt_import: 00:00:00:00:07:09
        evpn_l3:
          enabled: true
    - name: evpn_gateway_l2_evpn_role_server
      id: 3
      filter:
        tenants: [ EVPN_GATEWAY_TESTS ]
      platform: vEOS
      mlag: false
      mgmt_ip: 192.168.0.206/24
      evpn_role: server
      evpn_gateway:
        evpn_l2:
          enabled: true
    - name: evpn_gateway_l2_l3_disabled
      id: 4
      filter:
        tenants: [ EVPN_GATEWAY_TESTS ]
      platform: vEOS
      mlag: false
      mgmt_ip: 192.168.0.207/24
      evpn_role: server

    - name: evpn_l2_multi_domain
      id: 5
      mgmt_ip: 192.168.100.101/24
      platform: vEOS
      filter:
        tenants: [ L2_MULTI_DOMAIN_DISABLED, L2_MULTI_DOMAIN_ENABLED ]
      bgp_as: 65001
      evpn_gateway:
        remote_peers:
          - hostname: DCI_TEST
            ip_address: 192.168.100.10
            bgp_as: 65002
        evpn_l2:
          enabled: true

tenants:
  - name: EVPN_GATEWAY_TESTS
    mac_vrf_vni_base: 10000
    vrfs:
      - name: VRF10
        vrf_vni: 10
        svis:
          - id: 11
            name: VRF10_VLAN11
            enabled: true
            ip_address_virtual: 10.10.11.1/24
          - id: 12
            name: VRF10_VLAN12
            enabled: true
            ip_address_virtual: 10.10.12.1/24
      - name: VRF11
        vrf_vni: 11
        svis:
          - id: 21
            name: VRF11_VLAN21
            enabled: true
            ip_address_virtual: 10.10.21.1/24
          - id: 22
            name: VRF11_VLAN22
            enabled: true
            ip_address_virtual: 10.10.22.1/24
          - id: 300
            name: VRF11_VLAN300
            enabled: true
            ip_virtual_router_addresses:
              - 10.100.100.1
    l2vlans:
      - id: 3401
        name: L2_VLAN3401
      - id: 3402
        name: L2_VLAN3402
  - name: L2_MULTI_DOMAIN_DISABLED
    mac_vrf_vni_base: 10000
    # Test to disable all vlans in Tenant for l2 multi-domain
    evpn_l2_multi_domain: false
    vrfs:
      - name: L2_MULTI_DOMAIN_NEUTRAL_1
        vrf_vni: 10
        svis:
          - id: 110
            name: L2_MULTI_DOMAIN_NEUTRAL
            enabled: true
            ip_address_virtual: 10.1.10.1/24
          - id: 111
            name: L2_MULTI_DOMAIN_ENABLED
            enabled: true
            ip_address_virtual: 10.1.11.1/24
            # Test to enable specific VLAN for l2 multi-domain when disabled on Tenant
            evpn_l2_multi_domain: true
      - name: L2_MULTI_DOMAIN_ENABLED
        vrf_vni: 11
        # Test to enable all vlans in VRF for l2 multi-domain when disabled on Tenant
        evpn_l2_multi_domain: true
        svis:
          - id: 150
            name: L2_MULTI_DOMAIN_NEUTRAL
            enabled: true
            ip_address_virtual: 10.1.50.1/24
          - id: 160
            name: L2_MULTI_DOMAIN_NEUTRAL
            enabled: true
            ip_address_virtual: 10.1.60.1/24
          - id: 170
            name: L2_MULTI_DOMAIN_DISABLED
            enabled: true
            ip_address_virtual: 10.1.70.1/24
            # Test to disable specific VLAN for l2 multi-domain when enabled on VRF
            evpn_l2_multi_domain: false
    l2vlans:
      - id: 180
        name: L2_MULTI_DOMAIN_NEUTRAL
      - id: 190
        name: L2_MULTI_DOMAIN_ENABLED
        # Test to enable specific VLAN for l2 multi-domain when disabled on Tenant
        evpn_l2_multi_domain: true

  - name: L2_MULTI_DOMAIN_ENABLED
    mac_vrf_vni_base: 20000
    # Test to enable all vlans in Tenant for l2 multi-domain
    evpn_l2_multi_domain: true
    vrfs:
      - name: L2_MULTI_DOMAIN_NEUTRAL_2
        vrf_vni: 20
        svis:
          - id: 210
            name: L2_MULTI_DOMAIN_NEUTRAL
            enabled: true
            ip_address_virtual: 10.2.10.1/24
          - id: 211
            name: L2_MULTI_DOMAIN_DISABLED
            enabled: true
            ip_address_virtual: 10.2.11.1/24
             # Test to disable specific VLAN for l2 multi-domain when enabled on Tenant
            evpn_l2_multi_domain: false
      - name: L2_MULTI_DOMAIN_DISBLED
        vrf_vni: 21
        # Test to disable all vlans in VRF for l2 multi-domain when enabled on Tenant
        evpn_l2_multi_domain: false
        svis:
          - id: 250
            name: L2_MULTI_DOMAIN_NEUTRAL
            enabled: true
            ip_address_virtual: 10.2.50.1/24
          - id: 260
            name: L2_MULTI_DOMAIN_NEUTRAL
            enabled: true
            ip_address_virtual: 10.2.60.1/24
          - id: 270
            name: L2_MULTI_DOMAIN_ENABLED
            enabled: true
            ip_address_virtual: 10.2.70.1/24
            # Test to enable specific VLAN in VRF for l2 multi-domain when disabled on VRF
            evpn_l2_multi_domain: true
    l2vlans:
      - id: 280
        name: L2_MULTI_DOMAIN_NEUTRAL
      - id: 290
        name: L2_MULTI_DOMAIN_DISABLED
        # Test to disable specific VLAN for l2 multi-domain when enabled on Tenant
        evpn_l2_multi_domain: false
