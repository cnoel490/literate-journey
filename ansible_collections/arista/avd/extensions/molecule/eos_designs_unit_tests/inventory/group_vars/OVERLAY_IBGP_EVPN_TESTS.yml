type: l3leaf

fabric_evpn_encapsulation: mpls
overlay_routing_protocol: ibgp
evpn_overlay_bgp_rtc: true

l3leaf:
  defaults:
    loopback_ipv4_pool: 192.168.255.0/24
    vtep_loopback_ipv4_pool: 192.168.254.0/24
    virtual_router_mac_address: 00:1c:73:00:00:99
    bgp_as: 65233
  nodes:
    # RR peer with mpls_overlay_role:server and evpn_role:client
    - name: evpn_overlay_mpls_route_reflectors_ibgp
      id: 1
      platform: vEOS
      mlag: false
      mgmt_ip: 192.168.0.204/24
      evpn_role: client
      mpls_overlay_role: server
      overlay_address_families: [evpn]
    - name: evpn_overlay_mpls_route_reflectors2_ibgp
      id: 2
      platform: vEOS
      mlag: false
      mgmt_ip: 192.168.0.205/24
      evpn_role: server
      mpls_overlay_role: server
      overlay_address_families: [evpn]
      # Test when the peer is mpls server
      mpls_route_reflectors: [evpn_overlay_mpls_route_reflectors_ibgp]
    - name: evpn_role_server_overlay_vxlan_ibgp
      id: 3
      platform: vEOS
      mlag: false
      mgmt_ip: 192.168.0.206/24
      evpn_role: server
      overlay_address_families: [ evpn ]
