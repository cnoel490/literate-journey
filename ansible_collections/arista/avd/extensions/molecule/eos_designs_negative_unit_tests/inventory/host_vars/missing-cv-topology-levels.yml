---
fabric_name: FABRIC_MISSING_CV_TOPOLOGY_LEVELS
# Fabric node type keys
node_type_keys:
  - key: core_router
    type: core_router

bgp_as: 65000

# Nodes
type: core_router
core_router:
  defaults:
    loopback_ipv4_pool: 10.0.0.0/24
    loopback_ipv6_pool: "2000:1234:ffff:ffff::/64"
  nodes:
    - name: missing-cv-topology-levels
      id: 1
use_cv_topology: true
cv_topology:
  - hostname: missing-cv-topology-levels
    platform: vEOS-LAB
    interfaces:
      - name: Ethernet1
        neighbor: DC1-SUPER-SPINE1
        neighbor_interface: Ethernet5
      - name: Ethernet2
        neighbor: DC1-POD1-SPINE1
        neighbor_interface: Ethernet6
      - name: Ethernet3
        neighbor: DC1-POD1-LEAF1A
        neighbor_interface: Ethernet4
# Test that this is required with 'use_cv_topology: true'
# cv_topology_levels:
#   - type: core_router
#     level: 0
#   - type: super-spine
#     level: 1
#   - type: spine
#     level: 2
#   - type: l3leaf
#     level: 3
#   - type: l2leaf
#     level: 4

core_interfaces:
  p2p_links:
    - nodes: [missing-cv-topology-levels, peer1]
      id: 10
      ip: [192.168.0.2/31, 192.168.0.3/31]
      as: [65000, 65002]
      interfaces: [Ethernet1, Ethernet1]
      include_in_underlay_protocol: true
      multicast_pim_sm: true

expected_error_message: >-
  'cv_topology_levels' is required when 'use_cv_topology' is set to 'true'.
